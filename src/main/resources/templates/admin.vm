#disable_html_escaping()
<html>
<head>
    <title>$i18n.getText("jira-action-reminders.option.label")</title>
    $webResourceManager.requireResource("com.adsk.jira.actionreminders.plugin.jira-action-reminders-plugin:jira-action-reminders-plugin-resources")
    <meta name="decorator" content="atl.admin" />
    <meta name="application-base-url" content="$applicationProperties.getBaseUrl()" />    
    <script>        
        function prepareDelete(configId) {
            AJS.$("#ActionRemindersDel").stop().slideDown();
            AJS.$("#ActionRemindersRun").stop().slideUp();            
            
            AJS.$("#ActionRemindersDelForm input[name='configId']").val(configId);
            AJS.$("#ActionRemindersTitle").text(" | Deleting Mapping ID #"+configId);
            location.hash = "#ActionRemindersDel";
        }

        function prepareRun(configId) {
            AJS.$("#ActionRemindersRun").stop().slideDown();
            AJS.$("#ActionRemindersDel").stop().slideUp();            
            
            AJS.$("#ActionRemindersRunForm input[name='configId']").val(configId);
            AJS.$("#ActionRemindersTitle").text(" | Running Mapping ID #"+configId);
            location.hash = "#ActionRemindersRun";
        }

        function prepareSchedule() {
            AJS.$("#ActionRemindersDel").stop().slideUp();
            AJS.$("#ActionRemindersRun").stop().slideUp();            
            AJS.$("#ActionRemindersSchedule").stop().slideDown();
            location.hash = "#ActionRemindersSchedule";
        }
    </script>
</head>
<body>

<a href="#" class="actionreminders_schedule" onClick="prepareSchedule()" 
    title="Configure Run Schedule"></a>

<h2>$i18n.getText("jira-action-reminders.option.label")<span id="ActionRemindersTitle"></span></h2>


<!-- Delete form with Mapping ID -->
<div id="ActionRemindersDel" style="display: none">
<form id="ActionRemindersDelForm" class="aui" method="post" action="ActionRemindersConfig.jspa" >
<div class="field-group">
    <label for="configId">
        $i18n.getText("jira-action-reminders.option.map_id.label"):
        <span class="aui-icon icon-required"></span>
    </label>
    <input type="text" id="configId" name="configId" class="text" />
</div>
<div class="aui-buttons">
    <input class="aui-button" type="submit" name="submitted" value="DELETE" />
</div>
</form>
</div>

<!-- Run form with Mapping ID -->
<div id="ActionRemindersRun" style="display: none">
<form id="ActionRemindersRunForm" class="aui" method="post" action="ActionRemindersProjectConfig.jspa?projectKey=$projectKey" >
<div class="field-group">
    <label for="configId">
        $i18n.getText("jira-action-reminders.option.map_id.label"):
        <span class="aui-icon icon-required"></span>
    </label>
    <input type="text" id="configId" name="configId" class="text" />
</div>
<fieldset class="group">
    <legend><span>Options:</span></legend>
    <div class="checkbox">
        <input class="checkbox" type="checkbox" name="reminders" id="reminders" value="true" checked/>
        <label for="emailReminder">Reminders</label>
    </div>
    <div class="checkbox">
        <input class="checkbox" type="checkbox" name="actions" id="actions" value="true" />
        <label for="issueActions">Actions</label>
    </div>    
</fieldset>
<div class="aui-buttons">
    <input class="aui-button" type="submit" name="submitted" value="RUN" />
</div>
</form>
</div>


<!-- Configure Schedule -->
<div id="ActionRemindersSchedule" style="display: none;">
<form id="ActionRemindersScheduleForm" class="aui" method="post" action="ActionRemindersConfig.jspa" >
<div class="field-group">
    <label for="interval">
        $i18n.getText("jira.okta.group.configure.option.interval.label"):
        <span class="aui-icon icon-required"></span>
    </label>
    <input type="number" id="interval" name="interval" class="text" min="1" value="$!interval" />
</div>
<div class="aui-buttons">
    <input class="aui-button" type="submit" name="submitted" value="Schedule" />
</div>
</form>
</div>



<!-- config status -->
<p id="ActionRemindersStatus" style="background-color:#E0FFFF;">$!status</p>


<br/>

<span class="actionremindersconfig_count_span">Count &diams; <span id="actionremindersconfig_count">$configList.size()</span></span>
<div class="actionremindersconfig_search_div">
    <input type="text" id="actionremindersconfig_search" placeholder=" Search" onkeyup="actionremindersconfig_filter(this)" />
</div>

<!-- config display -->

<div id="ActionRemindersDisplay">
<table class="aui" id="actionreminders_configs">
    <tr><th>Config ID</th><th>Project</th><th>JQL Query</th><th>Action</th><th>Author</th><th>Last Run</th><th>Exec</th><th>Active?</th><th></th></tr>
    #foreach ($entry in $configList)
        <tr><td>$entry.configId</td><td>$entry.projectKey</td><td>$entry.query</td><td>$entry.issueAction</td>
            <td>$entry.runAuthor</td><td>$entry.lastRun</td><td>$entry.execCount</td><td>$entry.active</td>
            <td>
                <a href="#" class="actionreminders_run" onClick="prepareRun('$entry.configId')"></a>
                <a href="#" class="actionreminders_delete" onClick="prepareDelete('$entry.configId')"></a>
            </td>
        </tr>
    #end
</table>
</div>

</body>
</html>
